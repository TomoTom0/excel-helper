# 使い方ガイド

## 概要

Excel Helperは、固定長データとTSV/CSV形式の相互変換、およびナンバリング行の変換を行うWebアプリケーションです。

## 機能一覧

### 1. 固定長相互変換

固定長形式のデータとTSV/CSV形式のデータを相互に変換します。

#### 固定長 → TSV/CSV変換

**使い方**:
1. 「カラムごとの長さ」に各カラムの文字数をカンマ区切りで入力
   - 例: `10,20,15`
2. 「データ本体」に固定長形式のデータを貼り付け
3. 「固定長 → TSV/CSV」ボタンをクリック
4. 実行結果が表示されます

**オプション**:
- **入力形式**: 自動判別、TSV、CSVから選択（デフォルト: 自動判別）
- **出力形式**: TSV、CSVから選択（デフォルト: TSV）
- **カラムタイトル**: 任意でカラム名を指定可能

#### TSV/CSV → 固定長変換

**使い方**:
1. 「カラムごとの長さ」に各カラムの文字数をカンマ区切りで入力
2. 「データ本体」にTSV/CSV形式のデータを貼り付け
3. オプションで「カラムごとのオプション」を設定
4. 「TSV/CSV → 固定長」ボタンをクリック

**カラムごとのオプション形式**:
```
データ型:padding方向[:padding文字]
```

- **データ型**: `string` または `number`
- **padding方向**: `left` または `right`
- **padding文字**: 省略可（デフォルト: numberは`0`, stringは半角空白）

例:
```
string:right,string:right,number:left
string:right: ,number:left:0
```

### 2. ナンバリング行変換

TSV/CSVデータ内の各セルで、ナンバリング行（行頭に番号がある行）を検出し、指定した形式に統一します。

#### 使い方

1. **入力形式を選択**: 自動判別、TSV、CSVから選択（デフォルト: 自動判別）
2. **データ本体を貼り付け**: TSV/CSV形式のデータを入力
3. **検出対象パターンを選択**（複数選択可）:
   - 丸数字 `①②③`
   - 数字+ドット `1. 2. 3.`
   - 括弧囲み数字 `(1) (2) (3)`
   - ダミー文字（デフォルト: `x`、カスタマイズ可能）
4. **変換ボタンをクリック**
5. **実行結果から出力形式を選択**:
   - 番号形式: `①②③`, `1. 2. 3.`, `(1) (2) (3)`
   - データ形式: TSV, CSV

#### 使用例

**入力データ（TSV）**:
```
項目1	項目2	項目3
x概要説明
x詳細内容
①最初の項目
②次の項目	x準備
x実行
x確認	1. 初期設定
2. 動作確認
```

**検出パターン**: ダミー文字（x）、丸数字
**出力形式**: 数字+ドット

**出力結果**:
```
項目1	項目2	項目3
1. 概要説明
2. 詳細内容
1. 最初の項目
2. 次の項目	1. 準備
2. 実行
3. 確認	1. 初期設定
2. 動作確認
```

## 共通機能

### コピー機能

- 各入力フィールドの右上にあるコピーボタンでフィールド内容をクリップボードにコピー
- 実行結果の下にあるコピーボタンで結果全体をコピー

### クリア機能

- 各入力フィールドの右上にあるクリアボタンでフィールドをクリア

### ダウンロード機能

- 実行結果の下にあるダウンロードボタンで結果をテキストファイルとしてダウンロード

### 永続化

- Piniaストアを使用して入力内容を自動保存
- ブラウザを閉じても前回の入力内容が保持されます

## ヒント

### 固定長変換のヒント

- カラムごとの長さは正確に指定してください
- 固定長データの各行の文字数が一致しない場合、エラーが発生します
- 日本語などのマルチバイト文字も1文字としてカウントされます

### ナンバリング行変換のヒント

- ダミー文字は1文字で指定してください
- 複数のパターンを同時に検出できます
- 各セル内で独立してナンバリングが行われます（セルごとに1から開始）
- 行頭にパターンがマッチした行のみが変換対象となります
- 元のパターン（丸数字やダミー文字）は削除され、連番に置き換えられます

## トラブルシューティング

### エラー: カラム数が一致しません

**原因**: TSV/CSVデータの行によってカラム数が異なる場合

**解決方法**: データを確認し、すべての行のカラム数を統一してください

### エラー: 固定長データの行の長さが一致しません

**原因**: 固定長データの各行の文字数が指定した合計と異なる場合

**解決方法**: 
- カラムごとの長さの合計と各行の文字数を確認
- 余分な空白や改行がないか確認

### 変換結果が期待と異なる

**確認事項**:
- 入力形式（自動判別/TSV/CSV）が適切か
- 検出対象パターンが正しく選択されているか
- ダミー文字が正しく設定されているか
