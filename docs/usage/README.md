# 使い方ガイド

## 概要

Excel Helperは、固定長データとTSV/CSV形式の相互変換、およびナンバリング行の変換を行うWebアプリケーションです。

## 機能一覧

### 1. 固定長相互変換

<img src="../../imgs/demos/fixed-length-demo.gif" alt="固定長変換デモ" style="max-width: 80vw; max-height: 60vh;">

固定長形式のデータとTSV/CSV形式のデータを相互に変換します。

#### 固定長 → TSV/CSV変換

**入力例:**

カラムごとの長さ:
```
5,5,10
```

データ本体（固定長形式）:
```
AAAA BBBB CCCCCCCCCC
XXXX YYYY ZZZZZZZZZZ
1234 5678 ABCDEFGHIJ
```

**出力例（TSV形式）:**
```
AAAA	BBBB	CCCCCCCCCC
XXXX	YYYY	ZZZZZZZZZZ
1234	5678	ABCDEFGHIJ
```

**オプション:**
- **入力形式**: 自動判別、TSV、CSVから選択（デフォルト: 自動判別）
- **出力形式**: TSV、CSVから選択（デフォルト: TSV）
- **カラムタイトル**: 任意でカラム名を指定可能

#### TSV/CSV → 固定長変換

**入力例:**

カラムごとの長さ:
```
5,5,10
```

データ本体（TSV形式）:
```
AAAA	BBBB	CCCCCCCCCC
XXXX	YYYY	ZZZZZZZZZZ
1234	5678	ABCDEFGHIJ
```

カラムごとのオプション:
```
string:right,string:right,string:right
```

**出力例（固定長形式）:**
```
 AAAA BBBB CCCCCCCCCC
 XXXX YYYY ZZZZZZZZZZ
 1234 5678 ABCDEFGHIJ
```

**カラムごとのオプション形式**:
```
データ型:padding方向[:padding文字]
```

- **データ型**: `string` または `number`
- **padding方向**: `left` または `right`
- **padding文字**: 省略可（デフォルト: numberは`0`, stringは半角空白）

例:
```
string:right,string:right,number:left
string:right: ,number:left:0
```

### 2. ナンバリング行変換

<img src="../../imgs/demos/numbering-line-demo.gif" alt="ナンバリング行変換デモ" style="max-width: 80vw; max-height: 60vh;">

TSV/CSVデータ内の各セルで、行頭に番号が付いている行だけを検出し、指定した番号形式に変換します。番号が付いていない行はそのまま保持されます。**各セル内で番号は1から振り直されます。**

#### 基本的な変換例

**入力データ（CSV形式）:**
```
"⑤見出し1
詳細説明の内容
①見出し2
補足情報","③見出し3
説明文
⑧見出し4
②見出し5"
```

**検出対象パターン:** 丸数字（①②③⑤⑧）
**出力番号形式:** 1. 2. 3.
**出力データ形式:** TSV

**出力結果（TSV形式）:**
```
"1. 見出し1
詳細説明の内容
2. 見出し2
補足情報"	"1. 見出し3
説明文
2. 見出し4
3. 見出し5"
```

この例では：
- 左のセル: `⑤見出し1`、`①見出し2` → `1. 見出し1`、`2. 見出し2` に変換（元の番号⑤①に関わらず1, 2に振り直し）
- 左のセル: `詳細説明の内容`、`補足情報` → **そのまま残る**（番号なし行）
- 右のセル: `③見出し3`、`⑧見出し4`、`②見出し5` → `1. 見出し3`、`2. 見出し4`、`3. 見出し5` に変換（元の番号③⑧②に関わらず1, 2, 3に振り直し）
- 右のセル: `説明文` → **そのまま残る**（番号なし行）

#### 対応パターン

- **丸数字**: `①②③④⑤...`
- **数字+ドット**: `1. 2. 3. 4. 5. ...`
- **括弧囲み数字**: `(1) (2) (3) (4) (5) ...`
- **ダミー文字**: 任意の文字（デフォルト: `x`）- 行頭が指定文字で始まる行を検出

#### 複数パターン混在の例

**入力データ（TSV形式）:**
```
"②タスクA
手順の説明
⑤タスクB
実施内容
①タスクC"	"x項目1
詳細1
x項目2
詳細2
x項目3"	"3. 初期設定
設定内容
1. 動作確認
5. 完了確認"
```

**検出対象パターン:** 丸数字、ダミー文字（x）、数字+ドット
**出力番号形式:** (1) (2) (3)
**出力データ形式:** CSV

**出力結果（CSV形式）:**
```
"(1) タスクA
手順の説明
(2) タスクB
実施内容
(3) タスクC","(1) 項目1
詳細1
(2) 項目2
詳細2
(3) 項目3","(1) 初期設定
設定内容
(2) 動作確認
(3) 完了確認"
```

この例では：
- 左列: `②タスクA`、`⑤タスクB`、`①タスクC` → `(1) タスクA`、`(2) タスクB`、`(3) タスクC` に変換（元の番号②⑤①に関わらず1, 2, 3に振り直し）
- 左列: `手順の説明`、`実施内容` → **そのまま残る**
- 中央列: `x項目1`、`x項目2`、`x項目3` → `(1) 項目1`、`(2) 項目2`、`(3) 項目3` に変換
- 中央列: `詳細1`、`詳細2` → **そのまま残る**
- 右列: `3. 初期設定`、`1. 動作確認`、`5. 完了確認` → `(1) 初期設定`、`(2) 動作確認`、`(3) 完了確認` に変換（元の番号3, 1, 5に関わらず1, 2, 3に振り直し）
- 右列: `設定内容` → **そのまま残る**

## 共通機能

### コピー機能

- 各入力フィールドの右上にあるコピーボタンでフィールド内容をクリップボードにコピー
- 実行結果の下にあるコピーボタンで結果全体をコピー

### クリア機能

- 各入力フィールドの右上にあるクリアボタンでフィールドをクリア

### ダウンロード機能

- 実行結果の下にあるダウンロードボタンで結果をテキストファイルとしてダウンロード

### 永続化

- Piniaストアを使用して入力内容を自動保存
- ブラウザを閉じても前回の入力内容が保持されます

## ヒント

### 固定長変換のヒント

- カラムごとの長さは正確に指定してください
- 固定長データの各行の文字数が一致しない場合、エラーが発生します
- 日本語などのマルチバイト文字も1文字としてカウントされます

### ナンバリング行変換のヒント

- ダミー文字は1文字で指定してください
- 複数のパターンを同時に検出できます
- 各セル内で独立してナンバリングが行われます（セルごとに1から開始）
- 行頭にパターンがマッチした行のみが変換対象となります
- 元のパターン（丸数字やダミー文字）は削除され、連番に置き換えられます

## トラブルシューティング

### エラー: カラム数が一致しません

**原因**: TSV/CSVデータの行によってカラム数が異なる場合

**解決方法**: データを確認し、すべての行のカラム数を統一してください

### エラー: 固定長データの行の長さが一致しません

**原因**: 固定長データの各行の文字数が指定した合計と異なる場合

**解決方法**: 
- カラムごとの長さの合計と各行の文字数を確認
- 余分な空白や改行がないか確認

### 変換結果が期待と異なる

**確認事項**:
- 入力形式（自動判別/TSV/CSV）が適切か
- 検出対象パターンが正しく選択されているか
- ダミー文字が正しく設定されているか
